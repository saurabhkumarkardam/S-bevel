apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: supplychain
  namespace: carrier-quo
  annotations:
    fluxcd.io/automated: "false"
spec:
  releaseName: supplychain
  interval: 1m
  chart:
   spec:
    chart: platforms/quorum/charts/quorum-node
    sourceRef:
      kind: GitRepository
      name: flux-quo
      namespace: flux-quo
  values:
    global:
      serviceAccountName: vault-auth
      cluster:
        provider: aws
        cloudNativeServices: false
      vault:
        type: hashicorp
        network: quorum
        address: http://vault.internal.dev.aws.blockchaincloudpoc-develop.com:20002
        secretPrefix: "data/quocarrier"
        secretEngine: secretsv2
        role: vault-role
        authPath: quocarrier
      proxy:
        provider: ambassador
        externalUrlSuffix: sau99.dev.aws.blockchaincloudpoc-develop.com
        p2p: 15014
        tmport: 443
    storage:
      size: "2Gi"
    tessera:
      enabled: true
      tessera:
        port:
        resources:
          cpuLimit: 0.25
          cpuRequest: 0.05
          memLimit: "2G"
          memRequest: "1G"
        password: 'password'
      storage:
        enabled: false
        size: 1Gi
        dbSize: 2Gi
        allowedTopologies:
          enabled: false
          
    tls:
      enabled: true
      image:
        pullSecret: regcred
      settings:
        certSubject: 'CN=DLT Root CA,OU=DLT,O=DLT,L=London,C=GB'
        tmTls: strict


    node:
      goquorum:
        metrics:
          serviceMonitorEnabled: true
        resources:
          cpuLimit: 0.25
          cpuRequest: 0.05
          memLimit: "1G"
          memRequest: "300M"
        account:
          password: 'password'
        p2p:
          discovery: false
